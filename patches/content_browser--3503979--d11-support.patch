From 37d05397d6cd2047d53925eb43ba30bdcdb48564 Mon Sep 17 00:00:00 2001
From: quicksketch <nate@quicksketch.org>
Date: Mon, 24 Feb 2025 14:24:00 -0800
Subject: [PATCH 1/2] Issue #3503979: Drupal 11 compatibility.

---
 config/install/views.view.content_browser.yml | 1 -
 content_browser.info.yml                      | 2 +-
 src/Plugin/Block/ContentEmbedBlock.php        | 1 +
 3 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/config/install/views.view.content_browser.yml b/config/install/views.view.content_browser.yml
index c9d5a40..9dbb986 100644
--- a/config/install/views.view.content_browser.yml
+++ b/config/install/views.view.content_browser.yml
@@ -382,7 +382,6 @@ display:
             context_key: target_bundles
             fallback: all
             multiple: or
-          default_argument_skip_url: false
           summary_options:
             base_path: ''
             count: true
diff --git a/content_browser.info.yml b/content_browser.info.yml
index 6fe842b..ac76701 100644
--- a/content_browser.info.yml
+++ b/content_browser.info.yml
@@ -2,7 +2,7 @@ name: Content Browser
 description: 'Provides a default Entity Browser for default Content Entity types, using Masonry.'
 type: module
 core: 8.x
-core_version_requirement: ^8 || ^9 || ^10
+core_version_requirement: ^8 || ^9 || ^10 || ^11
 dependencies:
   - entity_browser:entity_browser
   - entity_embed:entity_embed
diff --git a/src/Plugin/Block/ContentEmbedBlock.php b/src/Plugin/Block/ContentEmbedBlock.php
index 8b51ab5..8277711 100644
--- a/src/Plugin/Block/ContentEmbedBlock.php
+++ b/src/Plugin/Block/ContentEmbedBlock.php
@@ -243,6 +243,7 @@ class ContentEmbedBlock extends BlockBase {
     if (!empty($this->configuration['uuids'])) {
       $nids = \Drupal::entityQuery('node')
         ->condition('uuid', $this->configuration['uuids'], 'IN')
+        ->accessCheck(TRUE)
         ->execute();
     }
     else {
-- 
GitLab


From 34402f6cedbf337b9c74ae019b0d6f1282976021 Mon Sep 17 00:00:00 2001
From: quicksketch <nate@quicksketch.org>
Date: Mon, 24 Feb 2025 14:29:10 -0800
Subject: [PATCH 2/2] Issue #3503979: Drupal 11 compatibility, fixing all
 deprecations.

---
 content_browser.info.yml | 2 +-
 content_browser.install  | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/content_browser.info.yml b/content_browser.info.yml
index ac76701..42f278d 100644
--- a/content_browser.info.yml
+++ b/content_browser.info.yml
@@ -2,7 +2,7 @@ name: Content Browser
 description: 'Provides a default Entity Browser for default Content Entity types, using Masonry.'
 type: module
 core: 8.x
-core_version_requirement: ^8 || ^9 || ^10 || ^11
+core_version_requirement: ^10.3 || ^11
 dependencies:
   - entity_browser:entity_browser
   - entity_embed:entity_embed
diff --git a/content_browser.install b/content_browser.install
index 06b76aa..e7efeed 100644
--- a/content_browser.install
+++ b/content_browser.install
@@ -8,7 +8,7 @@
 use Drupal\views\Entity\View;
 use Drupal\node\Entity\NodeType;
 use Drupal\Component\Serialization\Yaml;
-use Drupal\Core\File\FileSystemInterface;
+use Drupal\Core\File\FileExists;
 
 /**
  * Implements hook_install().
@@ -18,7 +18,7 @@ function content_browser_install() {
   if (!\Drupal::isConfigSyncing()) {
     $data = file_get_contents(dirname(__FILE__) . '/content_browser_icon.png');
     /** @var \Drupal\file\FileInterface $file */
-    $file = \Drupal::service('file.repository')->writeData($data, 'public://content_browser_icon.png', FileSystemInterface::EXISTS_REPLACE);
+    $file = \Drupal::service('file.repository')->writeData($data, 'public://content_browser_icon.png', FileExists::Replace);
     if ($file) {
       // Set file uuid same as default config.
       $uuid = Yaml::decode(file_get_contents(dirname(__FILE__) . '/config/install/embed.button.content_browser.yml'))['icon_uuid'];
-- 
GitLab

